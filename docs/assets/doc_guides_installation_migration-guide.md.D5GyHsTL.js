import{_ as i,c as a,a2 as e,o as t}from"./chunks/framework.BQmytedh.js";const k=JSON.parse('{"title":"Migration Guide","description":"","frontmatter":{},"headers":[],"relativePath":"doc/guides/installation/migration-guide.md","filePath":"doc/guides/installation/migration-guide.md"}'),n={name:"doc/guides/installation/migration-guide.md"};function l(h,s,r,o,p,d){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="migration-guide" tabindex="-1">Migration Guide <a class="header-anchor" href="#migration-guide" aria-label="Permalink to &quot;Migration Guide&quot;">​</a></h1><p>This guide describes how to migrate an existing ioChem-BD installation to a new clean machine. Follow these steps to ensure a smooth migration with minimal downtime.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Schedule the migration during a maintenance window or low-usage period to minimize disruption to users.</p></div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The migration process involves:</p><ol><li>Preparing the new machine</li><li>Backing up data from the old machine</li><li>Restoring data on the new machine</li><li>Updating configuration for the new environment</li><li>Verifying the installation</li></ol><h2 id="phase-1-prepare-the-new-machine" tabindex="-1">Phase 1: Prepare the New Machine <a class="header-anchor" href="#phase-1-prepare-the-new-machine" aria-label="Permalink to &quot;Phase 1: Prepare the New Machine&quot;">​</a></h2><h3 id="system-setup" tabindex="-1">System Setup <a class="header-anchor" href="#system-setup" aria-label="Permalink to &quot;System Setup&quot;">​</a></h3><p>Install all required software on the new machine:</p><p><strong>Operating System Requirements:</strong></p><ul><li>Linux OS 2.6.24 or greater (64 bit)</li><li>Tested on Ubuntu, CentOS, Fedora, and Debian distributions</li></ul><p><strong>Software Packages:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install Java JDK 17</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java-17-openjdk.x86_64</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # For CentOS/Fedora/Rocky</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openjdk-17-jdk</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # For Debian/Ubuntu</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install PostgreSQL (version 11 or newer)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # For CentOS/Fedora/Rocky</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # For Debian/Ubuntu</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install libcap for privileged port access</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libcap</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # For CentOS/Fedora/Rocky</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libcap2-bin</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # For Debian/Ubuntu</span></span></code></pre></div><p><strong>Hardware Verification:</strong></p><ul><li>Minimum 4 CPU cores (2GHz or better)</li><li>Minimum 16 GB RAM</li><li>Free disk space: At least 500 GB + current iochembd folder size</li></ul><h3 id="create-system-user" tabindex="-1">Create System User <a class="header-anchor" href="#create-system-user" aria-label="Permalink to &quot;Create System User&quot;">​</a></h3><p>Create the iochembd user account that will own the application files:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You can use a different username, but ensure it matches throughout the migration process.</p></div><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>When you migrate the program to the new machine it must be placed on the same parent folder structure (same folder names), otherwise the already defined configuration files will fail to find the content.</p></div><h2 id="phase-2-backup-data-from-old-machine" tabindex="-1">Phase 2: Backup Data from Old Machine <a class="header-anchor" href="#phase-2-backup-data-from-old-machine" aria-label="Permalink to &quot;Phase 2: Backup Data from Old Machine&quot;">​</a></h2><h3 id="database-backup" tabindex="-1">Database Backup <a class="header-anchor" href="#database-backup" aria-label="Permalink to &quot;Database Backup&quot;">​</a></h3><p>Export both PostgreSQL databases from the old machine:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run as the iochembd database user</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The password is stored inside configuration files such as </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># create/resource.properties then on create.database.pwd field</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate_backup.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse_backup.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Compress the backups to save space and transfer time</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate_backup.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse_backup.sql</span></span></code></pre></div><h3 id="file-system-backup" tabindex="-1">File System Backup <a class="header-anchor" href="#file-system-backup" aria-label="Permalink to &quot;File System Backup&quot;">​</a></h3><p>Identify and backup the following directory from the old installation:</p><p><strong>Application Files:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Backup the entire ioChem-BD installation folder, </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Usually it is called iochembd, but we will refer to it as BASE_PATH</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/iochembd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -czf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd_application.tar.gz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd/</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>The <em>assetstore</em> directories contained inside BASE_PATH contain all uploaded calculation files in both modules.</p><p>Assetstore directories can be very large. <strong>Ensure you have sufficient disk space and time for the backup</strong>.</p><p>An alternative is to copy the entire <em>BASE_PATH</em> folder to the new machine using <em>scp</em> command or mounting the remote destination folder with <em>sshfs</em> and then use <em>rsync</em> to migrate it.</p></div><p><strong>Transfer Backups:</strong></p><p>Copy all backup files to the new machine using your preferred method:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Example using scp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.sql.gz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd@new-machine:/home/iochembd/backup/</span></span></code></pre></div><h2 id="phase-3-restore-on-new-machine" tabindex="-1">Phase 3: Restore on New Machine <a class="header-anchor" href="#phase-3-restore-on-new-machine" aria-label="Permalink to &quot;Phase 3: Restore on New Machine&quot;">​</a></h2><h3 id="setup-postgresql" tabindex="-1">Setup PostgreSQL <a class="header-anchor" href="#setup-postgresql" aria-label="Permalink to &quot;Setup PostgreSQL&quot;">​</a></h3><p>Initialize and configure PostgreSQL on the new machine:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Initialize PostgreSQL databases (if not already done), only necessary on CentOS/Fedora/Rocky/RHEL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initdb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Configure PostgreSQL to start on boot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Edit pg_hba.conf to allow password authentication, folder names can vary depending on your version and OS</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># If file doesn&#39;t exist, just create it.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/postgresql/16/main/pg_hba.conf</span></span></code></pre></div><p>Add these lines to <code>pg_hba.conf</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># TYPE DATABASE USER ADDRESS METHOD</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># IPv4 local connections:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 127.0.0.1/32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md5</span></span></code></pre></div><p>Start PostgreSQL service:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgresql</span></span></code></pre></div><h3 id="create-postgresql-user-and-databases" tabindex="-1">Create PostgreSQL User and Databases <a class="header-anchor" href="#create-postgresql-user-and-databases" aria-label="Permalink to &quot;Create PostgreSQL User and Databases&quot;">​</a></h3><p>Create the database user with the <strong>same database password</strong> as the old installation:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Switch to postgres user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postgres$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> createuser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XXXXXXX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> again:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  XXXXXXX</span></span></code></pre></div><p>Create the two databases with UTF-8 encoding:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postgres$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> createdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --encoding=UTF8</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --template=template0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --owner=iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;iochemCreate&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postgres$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> createdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --encoding=UTF8</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --template=template0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --owner=iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;iochemBrowse&quot;</span></span></code></pre></div><h3 id="restore-database-content" tabindex="-1">Restore Database Content <a class="header-anchor" href="#restore-database-content" aria-label="Permalink to &quot;Restore Database Content&quot;">​</a></h3><p>Import the database backups:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Decompress the backup files</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gunzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate_backup.sql.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gunzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse_backup.sql.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Restore the databases</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemCreate_backup.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochemBrowse_backup.sql</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Database restoration can take several minutes to hours depending on the size of your data.</p></div><h3 id="install-iochem-bd-software" tabindex="-1">Install ioChem-BD Software <a class="header-anchor" href="#install-iochem-bd-software" aria-label="Permalink to &quot;Install ioChem-BD Software&quot;">​</a></h3><p>Once the databases are recovered, we will focus on the platform software + data.</p><p>Extract the application backup to the desired location:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/iochembd/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -xzf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd_application.tar.gz</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Remember again that this action requires the new machine to use the same directory paths as the old machine. If paths differ, you must update configuration files manually.</p></div><h2 id="phase-4-configuration-updates" tabindex="-1">Phase 4: Configuration Updates <a class="header-anchor" href="#phase-4-configuration-updates" aria-label="Permalink to &quot;Phase 4: Configuration Updates&quot;">​</a></h2><h3 id="update-network-configuration" tabindex="-1">Update Network Configuration <a class="header-anchor" href="#update-network-configuration" aria-label="Permalink to &quot;Update Network Configuration&quot;">​</a></h3><p>If the hostname or IP address has changed, update the following:</p><p><strong>1. Edit /etc/hosts:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts</span></span></code></pre></div><p>Add or update the entry:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     your-new-hostname.domain.com</span></span></code></pre></div><p><strong>2. SSL Certificate:</strong></p><p>If the hostname changed:</p><ul><li>The certificate generated during fresh installation will be correct</li><li>Or manually replace the certificate (see <a href="./../other-operations/replace-https-certificate.html">Replace HTTPS Certificate</a>)</li></ul><p>If using direct restoration with changed hostname:</p><ul><li>You must regenerate the SSL certificate</li><li>See <a href="./../other-operations/replace-https-certificate.html">Replace HTTPS Certificate</a></li></ul><h3 id="set-port-privileges" tabindex="-1">Set Port Privileges <a class="header-anchor" href="#set-port-privileges" aria-label="Permalink to &quot;Set Port Privileges&quot;">​</a></h3><p>When using privileged ports (below 1024, typically port 443 for HTTPS) you must run the following script as <em>root</em> user to allow java command to run on privileged ports:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BASE_PATH</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./postinstall.sh</span></span></code></pre></div><p>You must run the previous command each time you update the Java JDK package because the permissions are removed with the update process.</p><p>In order to avoid this situation, you can freeze your java package from updating with the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> versionlock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java-17-openjdk.x86_64</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # For CentOS/Fedora/Rocky</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hold</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openjdk-17-jdk</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # For Debian/Ubuntu</span></span></code></pre></div><h2 id="phase-5-start-and-verify" tabindex="-1">Phase 5: Start and Verify <a class="header-anchor" href="#phase-5-start-and-verify" aria-label="Permalink to &quot;Phase 5: Start and Verify&quot;">​</a></h2><p>First verify all migrated files in BASE_PATH belong to <em>iochembd</em> user, otherwise use this command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iochembd:iochembd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BASE_PATH</span></span></code></pre></div><h3 id="start-services" tabindex="-1">Start Services <a class="header-anchor" href="#start-services" aria-label="Permalink to &quot;Start Services&quot;">​</a></h3><p>Start the ioChem-BD web service as <em>iochembd</em> user:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BASE_PATH/apache-tomcat/bin/startup.sh</span></span></code></pre></div><h3 id="monitor-startup" tabindex="-1">Monitor Startup <a class="header-anchor" href="#monitor-startup" aria-label="Permalink to &quot;Monitor Startup&quot;">​</a></h3><p>Watch the log file for any startup errors:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iochembd$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BASE_PATH/apache-tomcat/logs/catalina.out</span></span></code></pre></div><p>Wait until you see messages indicating successful startup (typically &quot;Server startup in X ms&quot;).</p><h3 id="verify-installation" tabindex="-1">Verify Installation <a class="header-anchor" href="#verify-installation" aria-label="Permalink to &quot;Verify Installation&quot;">​</a></h3><p>If the old and new servers are running in parallel, you can edit your local machine <em>/etc/hosts</em> to point the new machine IP and test following functionalities, remember to undo this operation once testing is over.</p><p>Perform these verification steps:</p><p><strong>1. Access Web Interface:</strong></p><p>Open your web browser and navigate to:</p><ul><li>Main page: <code>https://your-hostname/</code></li><li>Create module: <code>https://your-hostname/create</code></li><li>Browse module: <code>https://your-hostname/browse</code></li></ul><p><strong>2. Test Administrator Login:</strong></p><ul><li>Go to Browse module</li><li>Login with administrator credentials</li><li>Verify you can see all users on &quot;Administer-&gt; Access Control-&gt; E-people&quot;</li></ul><p><strong>3. Test User Access:</strong></p><ul><li>Go to Create module</li><li>Login as a regular user</li><li>Verify access to their projects</li><li>Check file viewing and download functionality</li></ul><p><strong>4. Verify Published Data:</strong></p><ul><li>Browse the public repository</li><li>Search for published items</li><li>Verify molecular visualizations load correctly</li></ul><p><strong>5. Test File Operations:</strong></p><ul><li>Upload a small test calculation file</li><li>Verify conversion completes successfully</li><li>Check file is properly stored and viewable</li></ul><p><strong>6. Test Email Notifications:</strong></p><ul><li>Trigger an email notification (e.g., password reset request)</li><li>Verify email is received correctly</li></ul><p><strong>7. Check Search Functionality:</strong></p><ul><li>Perform searches in Create module</li><li>Verify search results are accurate and complete</li></ul><h3 id="update-dns-if-applicable" tabindex="-1">Update DNS (if applicable) <a class="header-anchor" href="#update-dns-if-applicable" aria-label="Permalink to &quot;Update DNS (if applicable)&quot;">​</a></h3><p>If you&#39;re replacing the production server:</p><ol><li>Update DNS records to point to the new server&#39;s IP address</li><li>Wait for DNS propagation (can take up to 48 hours)</li><li>Monitor old server logs to ensure traffic has shifted to new server</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Consider using a lower TTL value for your DNS records before migration to speed up propagation.</p></div><h2 id="migration-checklist" tabindex="-1">Migration Checklist <a class="header-anchor" href="#migration-checklist" aria-label="Permalink to &quot;Migration Checklist&quot;">​</a></h2><p>Use this checklist to track your migration progress:</p><ul><li>[ ] New machine meets all system requirements</li><li>[ ] Java JDK 17 installed</li><li>[ ] PostgreSQL installed and configured</li><li>[ ] System user (iochembd) created</li><li>[ ] Databases backed up from old machine</li><li>[ ] Application folder backed up from old machine</li><li>[ ] All backups transferred to new machine</li><li>[ ] PostgreSQL databases restored</li><li>[ ] Database credentials match old installation</li><li>[ ] ioChem-BD software installed</li><li>[ ] SSL certificate configured correctly</li><li>[ ] /etc/hosts file updated</li><li>[ ] Port privileges set (postinstall.sh executed)</li><li>[ ] Web service started successfully</li><li>[ ] No errors in catalina.out log</li><li>[ ] Administrator can login to Browse module</li><li>[ ] Regular users can access their data</li><li>[ ] All projects and calculations visible</li><li>[ ] File upload and conversion working</li><li>[ ] Search functionality operational</li><li>[ ] Browse module shows published content</li><li>[ ] Email notifications sending correctly</li><li>[ ] DNS updated (if replacing production server)</li><li>[ ] Old server kept running until verification complete</li></ul><h2 id="rollback-plan" tabindex="-1">Rollback Plan <a class="header-anchor" href="#rollback-plan" aria-label="Permalink to &quot;Rollback Plan&quot;">​</a></h2><p>Keep the old server operational and accessible until you&#39;ve completed all verification steps. If you encounter critical issues:</p><ol><li>Keep users on the old server by not updating DNS or reverting DNS changes</li><li>Investigate and resolve issues on the new server</li><li>Re-attempt migration when ready</li></ol><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>Do not decommission the old server until the new installation has been verified and running successfully for at least several days.</p></div><h2 id="post-migration" tabindex="-1">Post-Migration <a class="header-anchor" href="#post-migration" aria-label="Permalink to &quot;Post-Migration&quot;">​</a></h2><p>After successful migration:</p><ol><li>Monitor the new server closely for the first few days</li><li>Check log files regularly for any errors or warnings</li><li>Verify backups are running correctly on the new system</li><li>Update any documentation with new server details</li><li>Notify users of any changes (new hostname, IP address, etc.)</li><li>Schedule the decommissioning of the old server</li></ol><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="database-connection-errors" tabindex="-1">Database Connection Errors <a class="header-anchor" href="#database-connection-errors" aria-label="Permalink to &quot;Database Connection Errors&quot;">​</a></h3><p>If you see database connection errors in the logs:</p><ul><li>Verify PostgreSQL is running: <code>service postgresql status</code></li><li>Check database credentials in configuration files</li><li>Verify pg_hba.conf entries are correct</li><li>Test database connection manually: <code>psql -U iochembd -h 127.0.0.1 iochemCreate</code></li></ul><h3 id="certificate-issues" tabindex="-1">Certificate Issues <a class="header-anchor" href="#certificate-issues" aria-label="Permalink to &quot;Certificate Issues&quot;">​</a></h3><p>If you see SSL certificate errors:</p><ul><li>Verify certificate was generated for correct hostname</li><li>Check certificate file permissions (should be readable by iochembd user)</li><li>See <a href="./../other-operations/replace-https-certificate.html">Replace HTTPS Certificate</a> for detailed troubleshooting</li></ul><h3 id="file-permission-errors" tabindex="-1">File Permission Errors <a class="header-anchor" href="#file-permission-errors" aria-label="Permalink to &quot;File Permission Errors&quot;">​</a></h3><p>If you see permission denied errors:</p><ul><li>Verify all files in BASE_PATH belong to iochembd user: <code>chown -R iochembd:iochembd BASE_PATH</code></li><li>Check assetstore directory permissions</li><li>Verify postinstall.sh was run as root for privileged ports</li></ul><h3 id="missing-data" tabindex="-1">Missing Data <a class="header-anchor" href="#missing-data" aria-label="Permalink to &quot;Missing Data&quot;">​</a></h3><p>If calculations or files are missing:</p><ul><li>Verify old backup did not fill disk or data migration did not fill the new machine disk</li><li>Verify database restoration completed successfully</li><li>Check assetstore directories were restored to correct locations</li><li>Verify assetstore paths in configuration match actual directory locations</li></ul><h2 id="getting-help" tabindex="-1">Getting Help <a class="header-anchor" href="#getting-help" aria-label="Permalink to &quot;Getting Help&quot;">​</a></h2><p>If you encounter issues during migration:</p><ul><li>Check the <a href="/doc/faqs/administration.html">FAQs</a> section</li><li>Review log files in <code>BASE_PATH/apache-tomcat/logs/</code></li><li>Contact support at <a href="mailto:contact@iochem-bd.org" target="_blank" rel="noreferrer">contact@iochem-bd.org</a></li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>When contacting support, include relevant log file excerpts and details about your migration steps.</p></div>`,131)]))}const g=i(n,[["render",l]]);export{k as __pageData,g as default};
